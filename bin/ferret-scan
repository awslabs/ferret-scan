#!/bin/bash

# Ferret Scan wrapper script to detect platform and use appropriate binary

# Detect OS and architecture
OS=$(uname -s | tr '[:upper:]' '[:lower:]')
ARCH=$(uname -m)

# Map architecture names
case $ARCH in
    x86_64)
        ARCH="amd64"
        ;;
    arm64|aarch64)
        ARCH="arm64"
        ;;
    *)
        echo "Unsupported architecture: $ARCH"
        exit 1
        ;;
esac

# Map OS names and set binary name
case $OS in
    darwin)
        BINARY="ferret-scan-darwin-$ARCH"
        ;;
    linux)
        BINARY="ferret-scan-linux-$ARCH"
        ;;
    mingw*|msys*|cygwin*)
        BINARY="ferret-scan-windows-$ARCH.exe"
        ;;
    *)
        echo "Unsupported operating system: $OS"
        exit 1
        ;;
esac

# Get the directory where this script is located
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Execute the appropriate binary
exec "$SCRIPT_DIR/$BINARY" "$@"